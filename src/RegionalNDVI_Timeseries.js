/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var arganier = ee.FeatureCollection("users/escaduto/Arganier"),
    ROI_A = 
    /* color: #0000ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.785976142462687, 31.23667202862195],
          [-9.785976142462687, 31.20679837933743],
          [-9.74168750720878, 31.20679837933743],
          [-9.74168750720878, 31.23667202862195]]], null, false),
    ROI_B = 
    /* color: #999900 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.786318548432746, 31.02761701824936],
          [-9.786318548432746, 30.999075366114145],
          [-9.744948156587043, 30.999075366114145],
          [-9.744948156587043, 31.02761701824936]]], null, false),
    ROI_C = 
    /* color: #009999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.73593637048225, 30.875777817685808],
          [-9.73593637048225, 30.844132649205836],
          [-9.693686214079662, 30.844132649205836],
          [-9.693686214079662, 30.875777817685808]]], null, false),
    ROI_D = 
    /* color: #99ff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.795558545231188, 30.750536745046105],
          [-9.795558545231188, 30.72191243632185],
          [-9.752299878239, 30.72191243632185],
          [-9.752299878239, 30.750536745046105]]], null, false),
    ROI_E = 
    /* color: #9999ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.457584209100219, 30.43532722381669],
          [-9.457584209100219, 30.40623957211416],
          [-9.41209394420764, 30.40623957211416],
          [-9.41209394420764, 30.43532722381669]]], null, false),
    ROI_F = 
    /* color: #ffff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.149262725044196, 30.553649212226873],
          [-9.149262725044196, 30.520234606112066],
          [-9.096391020942633, 30.520234606112066],
          [-9.096391020942633, 30.553649212226873]]], null, false),
    ROI_G = 
    /* color: #99ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-8.57398441278633, 30.44782302438023],
          [-8.57398441278633, 30.413039705660758],
          [-8.517851142522659, 30.413039705660758],
          [-8.517851142522659, 30.44782302438023]]], null, false),
    ROI_H = 
    /* color: #ff99ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-8.748243912500357, 30.233524202378536],
          [-8.748243912500357, 30.19896142189123],
          [-8.691767319482778, 30.19896142189123],
          [-8.691767319482778, 30.233524202378536]]], null, false),
    ROI_I = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.18777841963606, 30.042286803140787],
          [-9.18777841963606, 30.00795432096012],
          [-9.135250038288405, 30.00795432096012],
          [-9.135250038288405, 30.042286803140787]]], null, false),
    ROI_J = 
    /* color: #98ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.395223815206009, 29.87674623828475],
          [-9.395223815206009, 29.84056976129193],
          [-9.337717253926712, 29.84056976129193],
          [-9.337717253926712, 29.87674623828475]]], null, false),
    ROI_K = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.516926115502656, 29.611513018917805],
          [-9.516926115502656, 29.573299917224805],
          [-9.453754728783906, 29.573299917224805],
          [-9.453754728783906, 29.611513018917805]]], null, false),
    ROI_L = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-9.91232244254843, 29.184656730533415],
          [-9.91232244254843, 29.142084986061786],
          [-9.844344537274992, 29.142084986061786],
          [-9.844344537274992, 29.184656730533415]]], null, false),
    North = /* color: #0b4a8b */ee.Geometry.Polygon(
        [[[-9.728156234955463, 30.629373967725687],
          [-9.621039535736713, 30.62464708929815],
          [-9.549628402924213, 30.65536767147232],
          [-9.524909164642963, 30.74983130030231],
          [-9.555121566986713, 30.806465056749197],
          [-9.571601059174213, 30.84420236362975],
          [-9.610053207611713, 30.879567614107355],
          [-9.612799789642963, 30.91963245616918],
          [-9.612799789642963, 30.952614438150174],
          [-9.582587387299213, 31.027959071542174],
          [-9.563361313080463, 31.103244153501308],
          [-9.607306625580463, 31.115002062772476],
          [-9.684210922455463, 31.115002062772476],
          [-9.697943832611713, 31.15496805981287],
          [-9.697943832611713, 31.19021818518896],
          [-9.643012191986713, 31.211361961366904],
          [-9.601813461517963, 31.309970392451103],
          [-9.577094223236713, 31.37096204304025],
          [-9.692450668549213, 31.37096204304025],
          [-9.780341293549213, 31.34281696358805],
          [-9.810553695892963, 31.18316920977471],
          [-9.810553695892963, 31.0938367778104],
          [-9.807807113861713, 30.99264868442498],
          [-9.807807113861713, 30.877210336612553],
          [-9.807807113861713, 30.773432750617726],
          [-9.854499008392963, 30.68844046051367]]]),
    Central = /* color: #ffc82d */ee.Geometry.Polygon(
        [[[-9.561779199763919, 30.347209624455502],
          [-9.402477441951419, 30.356690141626064],
          [-9.303600488826419, 30.484587139053428],
          [-9.144298731013919, 30.494054318848203],
          [-8.968517481013919, 30.498787563331724],
          [-8.781749902888919, 30.512985914873582],
          [-8.578502832576419, 30.62177102162038],
          [-8.457653223201419, 30.664305878549026],
          [-8.265392481013919, 30.635951385665333],
          [-8.270885645076419, 30.531913825022286],
          [-8.386242090388919, 30.479853203784366],
          [-8.600475488826419, 30.423028029472782],
          [-8.803722559138919, 30.423028029472782],
          [-8.919079004451419, 30.347209624455502],
          [-8.968517481013919, 30.21913281408865],
          [-9.078380762263919, 30.16690547812582],
          [-9.226696191951419, 30.20489174254454],
          [-9.314586816951419, 30.21913281408865],
          [-9.429943262263919, 30.285563882012735],
          [-9.528820215388919, 30.228625716586663],
          [-9.402477441951419, 30.20489174254454],
          [-9.342052637263919, 30.09564177140514],
          [-9.320079981013919, 29.967237597955307],
          [-9.155285059138919, 29.952960204397247],
          [-8.963024316951419, 29.9767547208857],
          [-8.842174707576419, 30.07662943084144],
          [-8.578502832576419, 30.119402056042606],
          [-8.314830957576419, 30.23337182421171],
          [-8.128063379451419, 30.44670921193522],
          [-8.139049707576419, 30.612316291305504],
          [-8.193981348201419, 30.73987718470577],
          [-8.320324121638919, 30.791798104341588],
          [-8.523571191951419, 30.79651679877115],
          [-8.671886621638919, 30.69265205407073],
          [-8.820202051326419, 30.64540380716663],
          [-9.017955957576419, 30.64067771188275],
          [-9.259655176326419, 30.61704377187751],
          [-9.375011621638919, 30.512985914873582],
          [-9.583751856013919, 30.460915160723243]]]),
    South = /* color: #00ffff */ee.Geometry.Polygon(
        [[[-10.017711816951419, 29.006147486608103],
          [-9.743053613826419, 28.99653875239955],
          [-9.644176660701419, 29.121382560855974],
          [-9.490368066951419, 29.389762309476776],
          [-9.347545801326419, 29.600136897604813],
          [-9.061901270076419, 29.96247869463571],
          [-9.369518457576419, 30.038593788016414],
          [-9.490368066951419, 29.84819670337004],
          [-9.556286035701419, 29.686073126271307],
          [-9.688121973201419, 29.495004220483704],
          [-9.968383264345675, 29.528505195369682],
          [-10.061657129451419, 29.332311676474124]]]),
    geometry = 
    /* color: #bf04c2 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-10.374681650325442, 31.849980972710032],
          [-10.374681650325442, 28.845102289369724],
          [-8.012621103450442, 28.845102289369724],
          [-8.012621103450442, 31.849980972710032]]], null, false);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

Map.addLayer(arganier, '', 'argan');

// Analysis by Region 
var regions = ee.FeatureCollection([
  ee.Feature( 
North, {label: 'North'}),
  ee.Feature( 
South, {label: 'South'}),
  ee.Feature( 
Central, {label: 'Central'})
]);

// This function adds a band representing the image timestamp.
var threshold = function(image) {
  return image.gt(0.14).and(image.lt(0.17))
  .copyProperties(image, ['system:time_start']);
};

var L8_NDVI = ee.ImageCollection('LANDSAT/LC08/C01/T1_8DAY_NDVI')
                  .filter(ee.Filter.calendarRange(2013,2019,'year'))
                  .filter(ee.Filter.calendarRange(7,9,'month'))
                  .select('NDVI')
                  .map(threshold);

var L7_NDVI = ee.ImageCollection('LANDSAT/LE07/C01/T1_8DAY_NDVI')
                  .filter(ee.Filter.calendarRange(1999,2019,'year'))
                  .filter(ee.Filter.calendarRange(7,9,'month'))
                  .select('NDVI')
                  .map(threshold);
                  
var L5_NDVI = ee.ImageCollection('LANDSAT/LT05/C01/T1_8DAY_NDVI')
                  .filter(ee.Filter.calendarRange(1984,2012,'year'))
                  .filter(ee.Filter.calendarRange(7,9,'month'))
                  .select('NDVI')
                  .map(threshold);
                
var RAW_NDVI = L5_NDVI.merge(L8_NDVI).sort("system:time_start");

Map.setOptions('satellite');
Map.addLayer(RAW_NDVI.filterBounds(geometry), {}, 'argan');

// Call seriesByRegion plot function, set chart type, and add .setOptions() 
var NDVITimeSeries = ui.Chart.image.seriesByRegion(
    RAW_NDVI, regions, ee.Reducer.mean(), 'NDVI', 2000,'system:time_start', 'label')
        .setChartType('ScatterChart')
        .setOptions({
          title: 'NDVI Regional Timeseries',
          vAxis: {title: 'NDWI'},
          lineWidth: 0,
          pointSize: 2,
          series: {
            0: {color: '0000FF'}, // roi1
            1: {color: '00FF00'}, // roi2
            2: {color: 'f9b51f'}, // roi3
}});

// Display NDWI Time Series
print(NDVITimeSeries);

/*
// create feature collection for NorthernShp; CentralShp; SouthernShp
var SouthernShp = ee.FeatureCollection([
  ROI_I,
  ROI_J,
  ROI_K,
  ROI_L
]);

// Export the FeatureCollection to a SHP file.
Export.table.toDrive({
  collection: SouthernShp,
  description:'SouthernShp',
  fileFormat: 'SHP'
});
*/